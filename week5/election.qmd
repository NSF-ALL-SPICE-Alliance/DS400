---
title: "The Beta-Binomial Bayesian Model"
format: html
editor: visual
---

```{r, message=FALSE}
library(tidyverse)
library(bayesrules)
```

#### 

#### Background (Prior)

Every four years, Americans go to the polls to cast their vote for President of the United States. Consider the following scenario. “Michelle” has decided to run for president and you’re her campaign manager for the state of Minnesota. As such, you’ve conducted 30 different polls throughout the election season. Though Michelle’s support has hovered around 45%, she polled at around 35% in the dreariest days and around 55% in the best days on the campaign trail.

![](images/prior-election-ch3-1.png){width="732"}

[FIGURE 3.1](https://www.bayesrulesbook.com/chapter-3#ch3-prior:~:text=3.1%20(left)). The results of 30 previous polls of Minnesotans’ support of Michelle for president (left) and a corresponding continuous prior model for π, her current election support (right).

What we’re modeling

π = true proportion that supports Michelle (a number in \[0,1\]).

Our prior mean is 0.45, the deviation from the mean is 0.35 - 0.55

α → how much “evidence” or “weight” toward π being near 1 (support)

β → how much “evidence” or “weight” toward π being near 0 (non-support)

**Mean:**\
\*\*Mean:\*\* α / (α + β) → the center of the distribution

In a trial and error process, we use `plot_beta()` in the **bayesrules** package to plot Beta models with α and β pairs that meet this constraint (e.g., Beta(9,11), Beta(27,33), Beta(45,55), Beta(90, 110).

Which of these code chunk creates a prior that best fits the prior information we were given?

```{r}
# Plot the Beta(9, 11) prior
plot_beta(9, 11)
```

```{r}
# Plot the Beta(45, 55) prior
plot_beta(27, 33)
```

```{r}
# Plot the Beta(45, 55) prior
plot_beta(45, 55)
```

```{r}
# Plot the Beta(45, 55) prior
plot_beta(90, 110)
```

**Beta(1,1):** flat → “I have no idea.”

**Beta(45,55):** peaked but flexible → “I think it’s about 45%, but I could be wrong.”

**Beta(90,110):** narrow → “I’m pretty sure it’s about 45%; you’ll need a lot of data to change my mind.”

This model is best understood by playing around. Figure [3.2](https://www.bayesrulesbook.com/chapter-3#fig:beta-tuning) plots the Beta pdf f(π) under a variety of **shape hyperparameters**, α and β. Check out the various shapes the Beta pdf can take. This flexibility means that we can *tune* the Beta to reflect our prior understanding of π by tweaking α and β.

![](images/beta-tuning-1.png)

![](images/beta_param_quiz.png){width="771" height="255"}

#### New Data

In the second step of our Bayesian analysis of Michelle’s election support π, you’re ready to collect some data. You plan to conduct a new poll of n=50 Minnesotans and record Y, the number that support Michelle. We ultimately observe that the poll was a huge success: Y=30 of n=50 (60%) polled voters support Michelle!

![](images/posterior_model_quiz.png){width="1033"}

```{r}
plot_beta_binomial(alpha = 45, beta = 55, y = 30, n = 50)
```

```{r}
summarize_beta_binomial(alpha = 45, beta = 55, y = 30, n = 50)
```

[**Exercise 3.1**](https://www.bayesrulesbook.com/chapter-3#ch3-prior:~:text=Beta%20prior%20models-,Exercise%203.1,-(Tune%20your%20Beta) **(Tune your Beta prior: Take I)** In each situation below, tune a Beta(α,β) model that accurately reflects the given prior information. In many cases, there’s no single “right” answer, but rather multiple “reasonable” answers.

1.  Your friend applied to a job and tells you: “I think I have a 40% chance of getting the job, but I’m pretty unsure.” When pressed further, they put their chances between 20% and 60%.

```{r}

```

1.  Your Aunt Jo is a successful mushroom hunter. She boasts: “I expect to find enough mushrooms to feed myself and my co-workers at the auto-repair shop 90% of the time, but if I had to give you a likely range it would be between 85% and 100% of the time.”

```{r}

```

[Exercise 3.16](https://www.bayesrulesbook.com/chapter-3#ch3-prior:~:text=0.9802%200.0002719%200.01649-,Exercise%203.16,-(Plotting%20the%20Beta) **(Plotting the Beta-Binomial: Take I)** Below is output from `plot_beta_binomial()` function.

![](images/clipboard-4119249586.png)

1.  Describe and compare both the prior model and likelihood function in words.

2.  Describe the posterior model in words. Does it more closely agree with the data (as reflected by the likelihood function) or the prior?

3.  Provide the specific `plot_beta_binomial()` code you would use to produce a similar plot.

```{r}

```
